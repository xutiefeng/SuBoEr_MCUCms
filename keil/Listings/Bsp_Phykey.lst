C51 COMPILER V9.60.0.0   BSP_PHYKEY                                                        10/18/2024 17:50:06 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE BSP_PHYKEY
OBJECT MODULE PLACED IN .\Objects\Bsp_Phykey.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE ..\BSP\Bsp_Phykey.c OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Libary\Devic
                    -e\CMS8S6990\Include;..\Libary\StdDriver\inc;..\code;..\u8g2;..\GUI) DEBUG PRINT(.\Listings\Bsp_Phykey.lst) TABS(2) OBJEC
                    -T(.\Objects\Bsp_Phykey.obj)

line level    source

   1          /*
   2           * @Author: xu_tie_feng xu_tie_feng@163.com
   3           * @Date: 2024-06-02 01:28:30
   4           * @LastEditors: xu_tie_feng xu_tie_feng@163.com
   5           * @LastEditTime: 2024-06-02 19:56:31
   6           * @FilePath: \LanYaDianReTan_8501\BSP\Bsp_Phykey.c
   7           * @Description: https://github.com/xu
   8           */
   9          #include "Bsp_Phykey.h"
  10          
  11          #define NO_KEY_PRESS_VALUE   0
  12          #define COLEECT_KEY_VALUE(X) str_IO.In_Put
  13          volatile TYP_IO  str_IO;
  14          
  15          extern void KeyShortPress(u8 v);
  16          extern void KeyLongPress(u8 v);
  17          
  18          /*********************************************************************************************************
             -********************************* 
  19          
  20          
  21          **********************************************************************************************************
             -********************************/
  22          void KeyProsess(u8 v)
  23          {
  24   1        u8 KeyValue = v;
  25   1        
  26   1        if( (NO_KEY_PRESS_VALUE == KeyValue)  || SysDelayFlag )
  27   1        {
  28   2            sKey_yyy.Bit.sProsessTime = 0;
  29   2            if(sKey_yyy.Bit.gNoKeyTime > 0)
  30   2            {
  31   3                  sKey_yyy.Bit.gNoKeyTime--;                
  32   3            } 
  33   2            else
  34   2            {
  35   3                  SysDelayFlag = 0;
  36   3            }
  37   2        }
  38   1        else
  39   1        {
  40   2              if(sKey_yyy.Bit.sProsessTime <0x3f)
  41   2                sKey_yyy.Bit.sProsessTime++;
  42   2              else
  43   2                return;
  44   2            
  45   2      
  46   2              if(sKey_yyy.Bit.sProsessTime >= _3S_Per50MS )//long press
  47   2              {         
  48   3                    SysDelayFlag = 1;//qu dou 
  49   3                    sKey_yyy.Bit.gNoKeyTime = _500MS_Per50MS;
  50   3                    KeyLongPress(KeyValue);           
  51   3                    sKey_yyy.Bit.sProsessTime = 0;
C51 COMPILER V9.60.0.0   BSP_PHYKEY                                                        10/18/2024 17:50:06 PAGE 2   

  52   3              }
  53   2              else
  54   2              {
  55   3                    sKey_yyy.Bit.sProsessTime = 0x3f;
  56   3                    KeyShortPress(KeyValue);
  57   3              } 
  58   2        }
  59   1      }
  60          
  61          void Kye_Scan(void)
  62          {
  63   1        if(str_IO.State < 2)//
  64   1        { 
  65   2            str_IO.In_Tmp[str_IO.State] = COLEECT_KEY_VALUE();
  66   2        }
  67   1        else
  68   1        {
  69   2          if((str_IO.In_Tmp[0] == str_IO.In_Tmp[1]))//
  70   2          {
  71   3            str_IO.KeyValue = str_IO.In_Tmp[0];
  72   3            KeyProsess(str_IO.In_Tmp[0] );
  73   3          }
  74   2          str_IO.State = 0;
  75   2          return;
  76   2        }
  77   1        str_IO.State ++;
  78   1      }
  79          
  80          /*********************************************************************************************************
             -********************************* 
  81          
  82          
  83          **********************************************************************************************************
             -********************************/
  84          
  85          
  86          u8 getKeyValue(void)
  87          {
  88   1          return  str_IO.KeyValue;
  89   1      }
  90          
  91          
  92          
  93          
*** WARNING C316 IN LINE 93 OF ..\BSP\Bsp_Phykey.c: unterminated conditionals


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    164    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      5       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
